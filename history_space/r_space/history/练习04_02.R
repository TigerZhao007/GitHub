library("RODBC")
connect <- odbcConnect("Rspace",uid = "sa",pwd = "sdk")
st0 <- sqlFetch(connect,"st_new")
head(st0)
st.num <- st0[c("height","weight","strength","speed")]
head(st.num)
attach(st0)
sex
fit <- lm(weight~height)
summary(fit)
head(weight)
head(fitted(fit))
head(residuals(fit))
plot(height,weight,xlab = "Height",ylab = "Weight",xlim = c(100,200))
abline(fit)
coefficients(fit)
fit2 <- lm(weight~height+I(height^2))
summary(fit2)
head(weight)
head(fitted(fit2))
head(residuals(fit2))
plot(height,weight,xlab = "Height",ylab = "Weight",xlim = c(100,200))
lines(height, fitted(fit2))
library(car)
scatterplot(weight~height,spread=F,smoother.args=list(lty=2),pch=2,
            main="student health", xlab = "height", ylab = "weigh")
cor(st.num)
scatterplotMatrix(st.num)

fit3 <- lm(speed~height+weight+strength)
summary(fit3)
fit4 <- lm(speed~height+weight+strength+height:weight)
summary(fit4)
coefficients(fit4)
head(weight)
fivenum(weight)
head(fitted(fit4))
head(residuals(fit4))
anova(fit4)
vcov(fit4)
AIC(fit4)
par(mfrow=c(2,2))
plot(fit4)
dev.off()
install.packages("effects")
library("effects")
plot(effect("height:weight", fit4, , list(weight=c(20,30,40))),multiline=T)
confint(fit4)
library(car)
qqPlot(fit4,labels=row.names(st0),
       id.method="identify",simulate=T,main="Q-Q plot")
residplot(fit4)
durbinWatsonTest(fit4)
crPlots(fit3)
fit4
ncvTest(fit4)
spreadLevelPlot(fit)
install.packages("gvlma")
library(gvlma)
gvlma(fit4)
gvmodel <- gvlma(fit4)
summary(gvmodel)
vif(fit4)
sqrt(vif(fit4)) > 2
outlierTest(fit4)
hat.plot(fit4)
hatvalues(fit4)
cutoff <- 4/(nrow(st0)-length(fit4$coefficients)/2)
plot(fit4, which = 4, cook.levels=cutoff)
abline(h=cutoff,lty=2, col=2)
avPlots(fit4, ask = F,id.method= "identily")
influencePlot(fit4,id.method = "identify",main="Influence", 
              sub="cook deistance")
summary(fit4)
pt <- powerTransform(speed)
pt
summary(pt)
boxTidwell(speed~height+weight,data=st0)    ###??????????

fit
fit2
fit3
fit4
anova(fit2,fit3)
AIC(fit2,fit3,fit4)
fit5 <- lm(speed~(height+weight+strength)^2)
fit5
library("MASS")
stepAIC(fit5,direction = "backward")

library("leaps")
leaps1 <- regsubsets(speed~height^2+weight^2+strength,data=st0,nbest = 4)
leaps1
plot(leaps1,scale = "adjr2")
subsets(leaps1, statistic = "cp", 
        main="caadfa")
install.packages("bootstrap")
library("bootstrap")
shrinkage(fit3)
shrinkage(fit2)
st1 <- st0[c("height", "weight", "strength", "speed")]
head(st1)
st1.1 <- as.data.frame(scale(st1))
head(st1.1)
zfit <- lm(speed~height+weight+strength,data = st1.1) 
summary(zfit)
coef(zfit)
x <- cor(fit5$model)
eigen(x)
relweights(fit3,col=2)
